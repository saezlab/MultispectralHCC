---
title: "Analysis of TCGA RPPA LIHC samples"
author: "Jovan Tanevski"
date: "`r Sys.Date()`"
output: workflowr::wflow_html
editor_options:
  chunk_output_type: console
---

## Setup

Load required libraries.

```{r setup}
library(tidyverse)
library(skimr)
library(uwot)
library(factoextra)
```

Read filtered TCGA RRPA data and display summary statistics.

```{r}
tcga <- read_csv("data/TCGA-RPPA-LIHC_selected.csv", col_types = cols())
skim(tcga)
```


## Unsupervised analysis

Perform hierarchical clustering of the data and plot the resulting dendrogram

```{r dev="svg", fig.width=16, fig.height=9}
tcga.dist <- dist(tcga %>% select(-SampleID, -TumorType))
tcga.hclust <- hclust(tcga.dist, method = "average")

plot(tcga.hclust,
  hang = -1, cex = 0.6,
  labels = tcga %>% pull("SampleID") %>%
    str_extract("[A-Z0-9]{2}-[A-Z0-9]{4}")
)
```

Project to 2D with PCA and UMAP and plot

```{r}
tcga.pca <- prcomp(tcga %>% select(-SampleID, -TumorType))
summary(tcga.pca)

fviz_pca_biplot(tcga.pca, label = "var", col.var = "cos2") + theme_classic()

tcga.umap <- umap(tcga %>% select(-SampleID, -TumorType),
  n_neighbors = 5, n_epochs = 1000
)
colnames(tcga.umap) <- c("U1", "U2")
                   
ggplot(tcga.umap %>% as_tibble(), aes(x = U1, y = U2)) +
  geom_point() +
  theme_classic()


```
